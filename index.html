<!DOCTYPE html>
<html lang="pt-BR">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Dashboard Pro - Multi-Servi√ßos</title>
<style>
  * { box-sizing: border-box; margin: 0; padding: 0; font-family: 'Inter', 'Segoe UI', sans-serif; }
  
  body { 
    display: flex; 
    height: 100vh; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    overflow: hidden;
  }
  
  .sidebar { 
    width: 80px; 
    background: linear-gradient(180deg, #1e293b 0%, #0f172a 100%);
    display: flex; 
    flex-direction: column; 
    align-items: center; 
    padding-top: 20px;
    box-shadow: 4px 0 20px rgba(0,0,0,0.3);
    position: relative;
    z-index: 10;
  }
  
  .sidebar .logo {
    font-size: 32px;
    margin-bottom: 40px;
    filter: drop-shadow(0 0 10px rgba(99, 102, 241, 0.8));
  }
  
  .sidebar button { 
    background: rgba(255,255,255,0.05);
    border: 2px solid transparent;
    color: #94a3b8; 
    font-size: 24px; 
    width: 50px;
    height: 50px;
    border-radius: 12px;
    margin: 12px 0; 
    cursor: pointer; 
    transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
    position: relative;
  }
  
  .sidebar button::after {
    content: attr(data-tooltip);
    position: absolute;
    left: 70px;
    top: 50%;
    transform: translateY(-50%);
    background: #1e293b;
    color: white;
    padding: 8px 12px;
    border-radius: 6px;
    font-size: 12px;
    white-space: nowrap;
    opacity: 0;
    pointer-events: none;
    transition: opacity 0.3s;
    box-shadow: 0 4px 12px rgba(0,0,0,0.3);
  }
  
  .sidebar button:hover::after {
    opacity: 1;
  }
  
  .sidebar button.active, .sidebar button:hover { 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-color: rgba(255,255,255,0.2);
    color: white;
    transform: scale(1.1);
    box-shadow: 0 8px 20px rgba(102, 126, 234, 0.4);
  }
  
  .main { 
    flex: 1; 
    padding: 30px; 
    overflow-y: auto;
    background: rgba(255,255,255,0.95);
    margin: 20px;
    border-radius: 24px;
    box-shadow: 0 20px 60px rgba(0,0,0,0.3);
  }
  
  .main::-webkit-scrollbar {
    width: 8px;
  }
  
  .main::-webkit-scrollbar-track {
    background: #f1f5f9;
    border-radius: 10px;
  }
  
  .main::-webkit-scrollbar-thumb {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border-radius: 10px;
  }
  
  .header {
    margin-bottom: 30px;
    display: flex;
    justify-content: space-between;
    align-items: center;
  }
  
  h1 { 
    color: #1e293b;
    font-size: 32px;
    font-weight: 700;
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    -webkit-background-clip: text;
    -webkit-text-fill-color: transparent;
  }
  
  .date-time {
    color: #64748b;
    font-size: 14px;
    font-weight: 500;
  }
  
  h2 { 
    margin-bottom: 20px; 
    color: #1e293b;
    font-size: 24px;
    font-weight: 600;
  }
  
  .service { 
    display: none;
    animation: fadeIn 0.5s ease-in-out;
  }
  
  @keyframes fadeIn {
    from { opacity: 0; transform: translateY(20px); }
    to { opacity: 1; transform: translateY(0); }
  }
  
  .service.active { 
    display: block; 
  }
  
  .metrics-grid {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
    gap: 20px;
    margin-bottom: 30px;
  }
  
  .metric-card {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    padding: 24px;
    border-radius: 16px;
    color: white;
    box-shadow: 0 10px 30px rgba(102, 126, 234, 0.3);
    transition: transform 0.3s;
  }
  
  .metric-card:hover {
    transform: translateY(-5px);
  }
  
  .metric-card .label {
    font-size: 14px;
    opacity: 0.9;
    margin-bottom: 8px;
  }
  
  .metric-card .value {
    font-size: 32px;
    font-weight: 700;
    margin-bottom: 4px;
  }
  
  .metric-card .change {
    font-size: 12px;
    opacity: 0.8;
  }
  
  input, textarea { 
    padding: 14px; 
    margin: 8px 0; 
    width: 100%; 
    border-radius: 12px; 
    border: 2px solid #e2e8f0;
    font-size: 14px;
    transition: all 0.3s;
    background: white;
  }
  
  input:focus, textarea:focus {
    outline: none;
    border-color: #667eea;
    box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
  }
  
  button.btn { 
    cursor: pointer; 
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    border: none; 
    color: white;
    font-weight: 600;
    border-radius: 12px; 
    padding: 14px 28px; 
    transition: all 0.3s;
    font-size: 14px;
    box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
  }
  
  button.btn:hover { 
    transform: translateY(-2px);
    box-shadow: 0 6px 20px rgba(102, 126, 234, 0.6);
  }
  
  button.btn:active {
    transform: translateY(0);
  }
  
  .card { 
    background: white;
    padding: 24px; 
    margin-bottom: 24px; 
    border-radius: 16px; 
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    border: 1px solid #f1f5f9;
  }
  
  .card h3 {
    color: #475569;
    font-size: 16px;
    margin-bottom: 16px;
    font-weight: 600;
  }
  
  ul { 
    list-style: none; 
    margin-top: 12px; 
    max-height: 300px; 
    overflow-y: auto;
  }
  
  li { 
    padding: 12px; 
    border-bottom: 1px solid #f1f5f9;
    color: #475569;
    font-size: 14px;
    transition: background 0.2s;
  }
  
  li:hover {
    background: #f8fafc;
  }
  
  li:last-child {
    border-bottom: none;
  }
  
  canvas { 
    width: 100% !important; 
    height: 350px !important;
    border-radius: 12px;
  }
  
  .chart-container {
    position: relative;
    background: white;
    padding: 20px;
    border-radius: 16px;
    box-shadow: 0 4px 20px rgba(0,0,0,0.08);
    margin-bottom: 24px;
  }
  
  .grid-2 {
    display: grid;
    grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
    gap: 24px;
  }
  
  .input-group {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 12px;
  }
  
  .result-box {
    background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    color: white;
    padding: 24px;
    border-radius: 12px;
    margin: 20px 0;
    text-align: center;
    box-shadow: 0 8px 25px rgba(102, 126, 234, 0.3);
  }
  
  .result-box .result-label {
    font-size: 14px;
    opacity: 0.9;
    margin-bottom: 8px;
  }
  
  .result-box .result-value {
    font-size: 42px;
    font-weight: 700;
  }
</style>
</head>
<body>

<div class="sidebar">
  <div class="logo">üìä</div>
  <button id="dashboard-btn" class="active" data-tooltip="Dashboard">üè†</button>
  <button id="post-btn" data-tooltip="Posts">‚úçÔ∏è</button>
  <button id="calc-btn" data-tooltip="Calculadora">üí∞</button>
  <button id="pdf-btn" data-tooltip="PDF">üìÑ</button>
</div>

<div class="main">
  <div class="header">
    <h1 id="page-title">Dashboard</h1>
    <div class="date-time" id="datetime"></div>
  </div>

  <!-- Dashboard Overview -->
  <div id="dashboard-service" class="service active">
    <div class="metrics-grid">
      <div class="metric-card">
        <div class="label">Total de Posts</div>
        <div class="value" id="total-posts">0</div>
        <div class="change">‚Üë 12% este m√™s</div>
      </div>
      <div class="metric-card">
        <div class="label">C√°lculos Realizados</div>
        <div class="value" id="total-calcs">0</div>
        <div class="change">‚Üë 8% este m√™s</div>
      </div>
      <div class="metric-card">
        <div class="label">PDFs Gerados</div>
        <div class="value" id="total-pdfs">0</div>
        <div class="change">‚Üë 15% este m√™s</div>
      </div>
      <div class="metric-card">
        <div class="label">Lucro M√©dio</div>
        <div class="value" id="avg-profit">R$ 0</div>
        <div class="change">‚Üë 22% este m√™s</div>
      </div>
    </div>

    <div class="grid-2">
      <div class="chart-container">
        <h3>Atividade Semanal</h3>
        <canvas id="activity-chart"></canvas>
      </div>
      <div class="chart-container">
        <h3>Performance</h3>
        <canvas id="performance-chart"></canvas>
      </div>
    </div>

    <div class="chart-container">
      <h3>Evolu√ß√£o de Lucro</h3>
      <canvas id="profit-evolution-chart"></canvas>
    </div>
  </div>

  <!-- Gerador de Posts -->
  <div id="post-service" class="service card">
    <h2>üìù Gerador de Posts</h2>
    <textarea id="post-text" rows="6" placeholder="Digite seu texto aqui..."></textarea>
    <button class="btn" onclick="savePost()">üíæ Salvar Post</button>
    <div class="card" style="margin-top: 24px;">
      <h3>Posts Salvos</h3>
      <ul id="post-list"></ul>
    </div>
  </div>

  <!-- Calculadora de Margem/Lucro -->
  <div id="calc-service" class="service">
    <h2>üí∞ Calculadora de Margem e Lucro</h2>
    <div class="card">
      <div class="input-group">
        <input type="number" id="cost" placeholder="üíµ Custo do Produto">
        <input type="number" id="price" placeholder="üí≤ Pre√ßo de Venda">
      </div>
      <button class="btn" onclick="calculateMargin()" style="width: 100%; margin-top: 12px;">üßÆ Calcular</button>
      <div id="margin-result"></div>
    </div>
    
    <div class="grid-2">
      <div class="chart-container">
        <h3>Hist√≥rico de C√°lculos</h3>
        <canvas id="profit-chart"></canvas>
      </div>
      <div class="chart-container">
        <h3>Distribui√ß√£o de Margem</h3>
        <canvas id="margin-distribution-chart"></canvas>
      </div>
    </div>
  </div>

  <!-- Gerador de PDF -->
  <div id="pdf-service" class="service card">
    <h2>üìÑ Gerador de PDF</h2>
    <input type="text" id="pdf-title" placeholder="üìã T√≠tulo do documento">
    <textarea id="pdf-text" rows="10" placeholder="Digite o conte√∫do para o PDF..."></textarea>
    <button class="btn" onclick="generatePDF()">‚¨áÔ∏è Gerar e Baixar PDF</button>
  </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<script>
  // Atualizar data/hora
  function updateDateTime() {
    const now = new Date();
    document.getElementById('datetime').textContent = now.toLocaleString('pt-BR');
  }
  updateDateTime();
  setInterval(updateDateTime, 1000);

  // Navega√ß√£o sidebar
  const dashboardBtn = document.getElementById('dashboard-btn');
  const postBtn = document.getElementById('post-btn');
  const calcBtn = document.getElementById('calc-btn');
  const pdfBtn = document.getElementById('pdf-btn');
  const services = {
    dashboard: document.getElementById('dashboard-service'),
    post: document.getElementById('post-service'),
    calc: document.getElementById('calc-service'),
    pdf: document.getElementById('pdf-service')
  };

  const titles = {
    dashboard: 'Dashboard',
    post: 'Gerador de Posts',
    calc: 'Calculadora de Lucro',
    pdf: 'Gerador de PDF'
  };

  function setActive(service) {
    for(let key in services) services[key].classList.remove('active');
    services[service].classList.add('active');
    document.getElementById('page-title').textContent = titles[service];
    
    dashboardBtn.classList.remove('active');
    postBtn.classList.remove('active');
    calcBtn.classList.remove('active');
    pdfBtn.classList.remove('active');
    
    if(service==='dashboard') dashboardBtn.classList.add('active');
    if(service==='post') postBtn.classList.add('active');
    if(service==='calc') calcBtn.classList.add('active');
    if(service==='pdf') pdfBtn.classList.add('active');
    
    if(service==='dashboard') updateDashboard();
  }

  dashboardBtn.onclick = ()=>setActive('dashboard');
  postBtn.onclick = ()=>setActive('post');
  calcBtn.onclick = ()=>setActive('calc');
  pdfBtn.onclick = ()=>setActive('pdf');

  // Gr√°fico de Atividade Semanal
  const activityCtx = document.getElementById('activity-chart').getContext('2d');
  const activityChart = new Chart(activityCtx, {
    type: 'bar',
    data: {
      labels: ['Dom', 'Seg', 'Ter', 'Qua', 'Qui', 'Sex', 'S√°b'],
      datasets: [{
        label: 'Atividades',
        data: [12, 19, 15, 25, 22, 30, 28],
        backgroundColor: 'rgba(102, 126, 234, 0.8)',
        borderColor: 'rgba(102, 126, 234, 1)',
        borderWidth: 2,
        borderRadius: 8
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        y: { beginAtZero: true, grid: { color: '#f1f5f9' } },
        x: { grid: { display: false } }
      }
    }
  });

  // Gr√°fico de Performance (Doughnut)
  const performanceCtx = document.getElementById('performance-chart').getContext('2d');
  const performanceChart = new Chart(performanceCtx, {
    type: 'doughnut',
    data: {
      labels: ['Posts', 'C√°lculos', 'PDFs'],
      datasets: [{
        data: [45, 30, 25],
        backgroundColor: [
          'rgba(102, 126, 234, 0.8)',
          'rgba(118, 75, 162, 0.8)',
          'rgba(237, 100, 166, 0.8)'
        ],
        borderWidth: 0
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: {
        legend: { position: 'bottom' }
      }
    }
  });

  // Gr√°fico de Evolu√ß√£o de Lucro
  const profitEvolutionCtx = document.getElementById('profit-evolution-chart').getContext('2d');
  const profitEvolutionChart = new Chart(profitEvolutionCtx, {
    type: 'line',
    data: {
      labels: ['Jan', 'Fev', 'Mar', 'Abr', 'Mai', 'Jun'],
      datasets: [{
        label: 'Lucro (R$)',
        data: [1200, 1900, 1500, 2500, 2200, 3000],
        borderColor: 'rgba(102, 126, 234, 1)',
        backgroundColor: 'rgba(102, 126, 234, 0.1)',
        borderWidth: 3,
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: true } },
      scales: {
        y: { beginAtZero: true, grid: { color: '#f1f5f9' } },
        x: { grid: { display: false } }
      }
    }
  });

  // LocalStorage Posts
  function savePost() {
    const text = document.getElementById('post-text').value.trim();
    if(!text) return alert('‚ö†Ô∏è Digite algo!');
    let posts = JSON.parse(localStorage.getItem('posts')||'[]');
    posts.push({text, date: new Date()});
    localStorage.setItem('posts', JSON.stringify(posts));
    loadPosts();
    document.getElementById('post-text').value='';
    updateDashboard();
  }

  function loadPosts() {
    const list = document.getElementById('post-list');
    list.innerHTML='';
    let posts = JSON.parse(localStorage.getItem('posts')||'[]');
    if(posts.length === 0) {
      list.innerHTML = '<li style="text-align:center; color:#94a3b8;">Nenhum post salvo ainda</li>';
      return;
    }
    posts.reverse().forEach(p=>{
      const li=document.createElement('li');
      li.innerHTML = `<strong>${new Date(p.date).toLocaleString('pt-BR')}</strong><br>${p.text}`;
      list.appendChild(li);
    });
  }
  loadPosts();

  // Calculadora e gr√°ficos
  const profitCtx = document.getElementById('profit-chart').getContext('2d');
  const profitChart = new Chart(profitCtx, {
    type: 'line',
    data: {
      labels: [],
      datasets: [{
        label: 'Lucro',
        data: [],
        borderColor: 'rgba(102, 126, 234, 1)',
        backgroundColor: 'rgba(102, 126, 234, 0.1)',
        borderWidth: 2,
        fill: true,
        tension: 0.4
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { display: false } },
      scales: {
        y: { beginAtZero: true, grid: { color: '#f1f5f9' } },
        x: { grid: { display: false } }
      }
    }
  });

  const marginDistCtx = document.getElementById('margin-distribution-chart').getContext('2d');
  const marginDistChart = new Chart(marginDistCtx, {
    type: 'pie',
    data: {
      labels: ['0-20%', '20-40%', '40-60%', '60-80%', '80-100%'],
      datasets: [{
        data: [0, 0, 0, 0, 0],
        backgroundColor: [
          'rgba(239, 68, 68, 0.8)',
          'rgba(251, 146, 60, 0.8)',
          'rgba(250, 204, 21, 0.8)',
          'rgba(34, 197, 94, 0.8)',
          'rgba(59, 130, 246, 0.8)'
        ],
        borderWidth: 0
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      plugins: { legend: { position: 'bottom' } }
    }
  });

  function calculateMargin() {
    const cost=parseFloat(document.getElementById('cost').value);
    const price=parseFloat(document.getElementById('price').value);
    if(isNaN(cost)||isNaN(price)) return alert('‚ö†Ô∏è Digite valores v√°lidos');
    
    const profit = price - cost;
    const margin = ((profit/price)*100).toFixed(2);
    
    const resultDiv = document.getElementById('margin-result');
    resultDiv.innerHTML = `
      <div class="result-box" style="margin-top: 20px;">
        <div class="result-label">Margem de Lucro</div>
        <div class="result-value">${margin}%</div>
        <div style="margin-top: 12px; font-size: 16px;">Lucro: R$ ${profit.toFixed(2)}</div>
      </div>
    `;

    // Salvar c√°lculo
    let calcs = JSON.parse(localStorage.getItem('calcs')||'[]');
    calcs.push({cost, price, profit, margin, date: new Date()});
    localStorage.setItem('calcs', JSON.stringify(calcs));

    // Atualizar gr√°fico de hist√≥rico
    const now = new Date().toLocaleTimeString('pt-BR', {hour: '2-digit', minute:'2-digit'});
    profitChart.data.labels.push(now);
    profitChart.data.datasets[0].data.push(profit);
    if(profitChart.data.labels.length > 10) {
      profitChart.data.labels.shift();
      profitChart.data.datasets[0].data.shift();
    }
    profitChart.update();

    // Atualizar distribui√ß√£o de margem
    updateMarginDistribution(margin);
    updateDashboard();
  }

  function updateMarginDistribution(margin) {
    let index = 0;
    if(margin > 20) index = 1;
    if(margin > 40) index = 2;
    if(margin > 60) index = 3;
    if(margin > 80) index = 4;
    
    marginDistChart.data.datasets[0].data[index]++;
    marginDistChart.update();
  }

  // Gera√ß√£o de PDF
  async function generatePDF() {
    const { jsPDF } = window.jspdf;
    const doc = new jsPDF();
    const title = document.getElementById('pdf-title').value || 'Documento';
    const text = document.getElementById('pdf-text').value;
    if(!text) return alert('‚ö†Ô∏è Digite algum texto!');
    
    // T√≠tulo
    doc.setFontSize(20);
    doc.setFont(undefined, 'bold');
    doc.text(title, 20, 20);
    
    // Data
    doc.setFontSize(10);
    doc.setFont(undefined, 'normal');
    doc.text(new Date().toLocaleString('pt-BR'), 20, 30);
    
    // Linha separadora
    doc.setLineWidth(0.5);
    doc.line(20, 35, 190, 35);
    
    // Conte√∫do
    doc.setFontSize(12);
    const lines = doc.splitTextToSize(text, 170);
    doc.text(lines, 20, 45);
    
    doc.save(`${title.replace(/\s+/g, '_')}.pdf`);
    
    // Salvar estat√≠stica
    let pdfs = JSON.parse(localStorage.getItem('pdfs')||'0');
    localStorage.setItem('pdfs', JSON.stringify(parseInt(pdfs) + 1));
    updateDashboard();
  }

  // Atualizar m√©tricas do dashboard
  function updateDashboard() {
    const posts = JSON.parse(localStorage.getItem('posts')||'[]');
    const calcs = JSON.parse(localStorage.getItem('calcs')||'[]');
    const pdfs = parseInt(localStorage.getItem('pdfs')||'0');
    
    document.getElementById('total-posts').textContent = posts.length;
    document.getElementById('total-calcs').textContent = calcs.length;
    document.getElementById('total-pdfs').textContent = pdfs;
    
    // Calcular lucro m√©dio
    if(calcs.length > 0) {
      const avgProfit = calcs.reduce((sum, c) => sum + c.profit, 0) / calcs.length;
      document.getElementById('avg-profit').textContent = `R$ ${avgProfit.toFixed(2)}`;
    }
  }

  updateDashboard();
</script>
</body>
</html>
